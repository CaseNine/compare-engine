This is the compare engine, writen in Javascript.